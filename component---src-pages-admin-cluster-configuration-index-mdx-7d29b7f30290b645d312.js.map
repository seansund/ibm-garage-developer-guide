{"version":3,"sources":["webpack:///./src/pages/admin/cluster-configuration/index.mdx"],"names":["name","_frontmatter","PageDescription","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-admin-cluster-configuration-index-mdx-7d29b7f30290b645d312.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/ibm-garage-developer-guide/ibm-garage-developer-guide/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <PageDescription mdxType=\"PageDescription\">\n      <p>{`Within the created Kubernetes or OpenShift cluster there are a number secrets\nand config maps that are either provided by the IBM Cloud public environment and\nutilized by the Terraform scripts or are created during the Terraform provisioning\nprocess.`}</p>\n    </PageDescription>\n    <h2>{`Namespaces`}</h2>\n    <p>{`The Iteration Zero scripts create four namespaces that are used by the components deployed into the cluster: `}<inlineCode parentName=\"p\">{`tools`}</inlineCode>{`,\n`}<inlineCode parentName=\"p\">{`dev`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`test`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`staging`}</inlineCode>{`. The actual names used for the namespaces are provided in Terraform variables with the\ndefaults being those listed. The variables are then passed into the namespaces module in `}<inlineCode parentName=\"p\">{`stage1-namespaces.tf`}</inlineCode>{`.`}</p>\n    <h2>{`Provided resources`}</h2>\n    <h3>{`TLS secret`}</h3>\n    <p>{`When the cluster is created, a secret containing the TLS certs for the ingress subdomain is provided in the\n`}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` namespace. The the name of the secret is based off of the cluster name with some rules applied to limit the\nlength and replace disallowed characters.`}</p>\n    <p><strong parentName=\"p\">{`Note:`}</strong>{` To avoid issues with the naming conventions for the secret, the Iteration Zero scripts look for the secret\nthat has a `}<inlineCode parentName=\"p\">{`tls.key`}</inlineCode>{` value: `}<inlineCode parentName=\"p\">{`kubectl get secrets -o jsonpath='{.items[?(@.data.tls\\\\.key != \"\")].metadata.name}'`}</inlineCode>{`.\nIdeally this would be identified using a label and a selector…`}</p>\n    <p>{`During the Iteration Zero process, the TLS secret is copied into each of the four namespaces created and used by the\nIteration Zero processes.`}</p>\n    <h3>{`Pull secrets`}</h3>\n    <p>{`Pull secrets for the IBM Cloud Image Registry are generated in the cluster as part of the Iteration Zero process to\nprepare the namespaces. The secrets are initially created in the `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` namespace with the following names:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`default-icr-io`}</inlineCode>{` `}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`default-{region}-icr-io`}</inlineCode>{` `}</li>\n    </ul>\n    <p>{`During the namespace preparation process, the pull secrets are copied into the different namespaces with `}<inlineCode parentName=\"p\">{`default-`}</inlineCode>{`\nprefix dropped. E.g.`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`icr-io`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`{region}-icr-io`}</inlineCode></li>\n    </ul>\n    <p>{`The pull secrets are also added to the `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` service account in each of the namespaces. As a result, it is not\nnecessary to directly reference the pull secret as long as the pod runs under the default service account.`}</p>\n    <h2>{`Created resources`}</h2>\n    <p>{`The following resources are all created during the Iteration Zero provisioning process. These resources\nare used generally to expose the config of the installed tools but specifically used by the CI pipeline (`}<a parentName=\"p\" {...{\n        \"href\": \"/guides/continuous-integration\"\n      }}>{`Jenkins`}</a>{`, `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/continuous-integration-tekton\"\n      }}>{`Tekton`}</a>{`, etc.) to interact with the deployed tools. The resources are bound as optional environment variables\nin the containers used within the pipeline so if a particular tool has not been installed the\nassociated environment variables won’t be set. For example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`  envFrom:\n    - configMapRef:\n        name: pactbroker-config\n        optional: true\n    - configMapRef:\n        name: sonarqube-config\n        optional: true\n    - secretRef:\n        name: sonarqube-access\n        optional: true\n`}</code></pre>\n    <h3>{`IBM Cloud config`}</h3>\n    <p>{`The Iteration Zero script creates a config map and secret named `}<inlineCode parentName=\"p\">{`ibmcloud-config`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`ibmcloud-access`}</inlineCode>{`\nin the `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` namespace that contains the relevant configuration values for the cluster within the IBM\nCloud account. The config map and secret are copied into each of the Iteration Zero namespaces as the\nnamespaces are created.`}</p>\n    <h4><inlineCode parentName=\"h4\">{`ibmcloud-config`}</inlineCode>{` config map`}</h4>\n    <p>{`The following values are collected:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`CLUSTER_TYPE - the type of cluster (kubernetes or openshift)`}</li>\n      <li parentName=\"ul\">{`APIURL - the api url used to connect to the IBM Cloud environment`}</li>\n      <li parentName=\"ul\">{`SERVER_URL - the server url used to connect to the cluster, particularly for OpenShift`}</li>\n      <li parentName=\"ul\">{`RESOURCE_GROUP - the IBM Cloud resource group where the cluster has been installed`}</li>\n      <li parentName=\"ul\">{`REGISTRY_URL - the url to the image registry`}</li>\n      <li parentName=\"ul\">{`REGISTRY_NAMESPACE - the namespace within the image registry where images will be stored`}</li>\n      <li parentName=\"ul\">{`REGION - the IBM Cloud region where where the cluster has been installed`}</li>\n      <li parentName=\"ul\">{`CLUSTER_NAME - the name of the cluster`}</li>\n      <li parentName=\"ul\">{`INGRESS_SUBDOMAIN - the subdomain for the cluster to use in building ingress urls`}</li>\n      <li parentName=\"ul\">{`TLS_SECRET_NAME - the name of the secret that contains the TLS certificate information`}</li>\n    </ul>\n    <h4><inlineCode parentName=\"h4\">{`ibmcloud-access`}</inlineCode>{` secret`}</h4>\n    <p>{`The following values are collected:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`APIKEY - the IBM Cloud apikey used to access the environment`}</li>\n    </ul>\n    <h3>{`ArgoCD config`}</h3>\n    <h4><inlineCode parentName=\"h4\">{`argocd-config`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`ARGOCD_URL - the url of the ArgoCD ingress`}</li>\n    </ul>\n    <h4><inlineCode parentName=\"h4\">{`argocd-access`}</inlineCode>{` secret`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`ARGOCD_PASSWORD - the password for the argocd user`}</li>\n      <li parentName=\"ul\">{`ARGOCD_USER - the user id of the argocd user`}</li>\n    </ul>\n    <h3>{`Artifactory config`}</h3>\n    <h4><inlineCode parentName=\"h4\">{`artifactory-config`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`ARTIFACTORY_URL - the url for the Artifactory ingress`}</li>\n    </ul>\n    <h4><inlineCode parentName=\"h4\">{`artifactory-access`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`ARTIFACTORY_USER - the user name of the admin user`}</li>\n      <li parentName=\"ul\">{`ARTIFACTORY_PASSWORD - the password for the admin user`}</li>\n      <li parentName=\"ul\">{`ARTIFACTORY_ENCRPT - the encrypted password for the admin user. This value is initially blank\nand must be updated after the value is generated in the UI`}</li>\n      <li parentName=\"ul\">{`ARTIFACTORY_ADMIN_ACCESS_USER - the admin access user`}</li>\n      <li parentName=\"ul\">{`ARTIFACTORY_ADMIN_ACCESS_PASSWORD - the admin access password`}</li>\n    </ul>\n    <h3>{`Jenkins config`}</h3>\n    <h4><inlineCode parentName=\"h4\">{`jenkins-config`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`JENKINS_HOST - the host name of the Jenkins ingress`}</li>\n      <li parentName=\"ul\">{`JENKINS_URL - the url of the Jenkins ingress`}</li>\n    </ul>\n    <h4><inlineCode parentName=\"h4\">{`jenkins-access`}</inlineCode>{` secret`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`api_token - the Jenkins api token`}</li>\n      <li parentName=\"ul\">{`host - the host name of the Jenkins ingress`}</li>\n      <li parentName=\"ul\">{`url - the url of the Jenkins ingress`}</li>\n      <li parentName=\"ul\">{`username - the Jenkins user name`}</li>\n      <li parentName=\"ul\">{`password - the Jenkins password`}</li>\n    </ul>\n    <h3>{`PactBroker config`}</h3>\n    <h4><inlineCode parentName=\"h4\">{`pactbroker-config`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`PACTBROKER_URL - the url of the Pact Broker ingress`}</li>\n    </ul>\n    <h3>{`SonarQube config`}</h3>\n    <h4><inlineCode parentName=\"h4\">{`sonarqube-config`}</inlineCode>{` config map`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`SONARQUBE_URL - the url of the SonarQube ingress`}</li>\n    </ul>\n    <h4><inlineCode parentName=\"h4\">{`sonarqube-access`}</inlineCode>{` secret`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`SONARQUBE_USER - the user name of the SonarQube user`}</li>\n      <li parentName=\"ul\">{`SONARQUBE_PASSWORD - the password of the SonarQube user`}</li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}