{"componentChunkName":"component---src-pages-admin-cluster-configuration-index-mdx","path":"/admin/cluster-configuration/","result":{"pageContext":{"frontmatter":{"title":"Cluster Configuration"},"relativePagePath":"/admin/cluster-configuration/index.mdx","titleType":"page","MdxNode":{"id":"feee9b3f-cb43-5385-b8df-d2397a777a89","children":[],"parent":"1e4077b8-80f8-5c52-94ea-eb7f8001391e","internal":{"content":"---\ntitle: Cluster Configuration\n---\n\n<PageDescription>\n\nWithin the created Kubernetes or OpenShift cluster there are a number secrets\nand config maps that are either provided by the IBM Cloud public environment and\nutilized by the Terraform scripts or are created during the Terraform provisioning\nprocess.\n\n</PageDescription>\n\n\n## Namespaces\n\nThe Iteration Zero scripts create four namespaces that are used by the components deployed into the cluster: `tools`, \n`dev`, `test`, and `staging`. The actual names used for the namespaces are provided in Terraform variables with the\ndefaults being those listed. The variables are then passed into the namespaces module in `stage1-namespaces.tf`.\n\n## Provided resources\n\n### TLS secret\n\nWhen the cluster is created, a secret containing the TLS certs for the ingress subdomain is provided in the \n`default` namespace. The the name of the secret is based off of the cluster name with some rules applied to limit the\nlength and replace disallowed characters.\n\n**Note:** To avoid issues with the naming conventions for the secret, the Iteration Zero scripts look for the secret\nthat has a `tls.key` value: `kubectl get secrets -o jsonpath='{.items[?(@.data.tls\\.key != \"\")].metadata.name}'`.\nIdeally this would be identified using a label and a selector...\n\nDuring the Iteration Zero process, the TLS secret is copied into each of the four namespaces created and used by the \nIteration Zero processes.\n\n### Pull secrets\n\nPull secrets for the IBM Cloud Image Registry are generated in the cluster as part of the Iteration Zero process to \nprepare the namespaces. The secrets are initially created in the `default` namespace with the following names:\n- `default-icr-io` \n- `default-{region}-icr-io` \n\nDuring the namespace preparation process, the pull secrets are copied into the different namespaces with `default-`\nprefix dropped. E.g.\n- `icr-io`\n- `{region}-icr-io`\n\nThe pull secrets are also added to the `default` service account in each of the namespaces. As a result, it is not \nnecessary to directly reference the pull secret as long as the pod runs under the default service account.\n\n## Created resources\n\nThe following resources are all created during the Iteration Zero provisioning process. These resources\nare used generally to expose the config of the installed tools but specifically used by the CI pipeline ([Jenkins](/tools/continuous-integration), [Tekton](/tools/continuous-integration-tekton), etc.) to interact with the deployed tools. The resources are bound as optional environment variables\nin the containers used within the pipeline so if a particular tool has not been installed the\nassociated environment variables won't be set. For example:\n\n```yaml\n  envFrom:\n    - configMapRef:\n        name: pactbroker-config\n        optional: true\n    - configMapRef:\n        name: sonarqube-config\n        optional: true\n    - secretRef:\n        name: sonarqube-access\n        optional: true\n```\n\n### IBM Cloud config\n\nThe Iteration Zero script creates a config map and secret named `ibmcloud-config` and `ibmcloud-access`\nin the `default` namespace that contains the relevant configuration values for the cluster within the IBM \nCloud account. The config map and secret are copied into each of the Iteration Zero namespaces as the \nnamespaces are created.\n\n#### `ibmcloud-config` config map\n \nThe following values are collected:\n \n- CLUSTER_TYPE - the type of cluster (kubernetes or openshift)\n- APIURL - the api url used to connect to the IBM Cloud environment\n- SERVER_URL - the server url used to connect to the cluster, particularly for OpenShift\n- RESOURCE_GROUP - the IBM Cloud resource group where the cluster has been installed\n- REGISTRY_URL - the url to the image registry\n- REGISTRY_NAMESPACE - the namespace within the image registry where images will be stored\n- REGION - the IBM Cloud region where where the cluster has been installed\n- CLUSTER_NAME - the name of the cluster\n- INGRESS_SUBDOMAIN - the subdomain for the cluster to use in building ingress urls\n- TLS_SECRET_NAME - the name of the secret that contains the TLS certificate information\n\n#### `ibmcloud-access` secret\n\nThe following values are collected:\n\n- APIKEY - the IBM Cloud apikey used to access the environment\n\n### ArgoCD config\n\n#### `argocd-config` config map\n\n- ARGOCD_URL - the url of the ArgoCD ingress\n\n#### `argocd-access` secret\n\n- ARGOCD_PASSWORD - the password for the argocd user\n- ARGOCD_USER - the user id of the argocd user\n\n### Artifactory config\n\n#### `artifactory-config` config map\n\n- ARTIFACTORY_URL - the url for the Artifactory ingress\n\n#### `artifactory-access` config map\n\n- ARTIFACTORY_USER - the user name of the admin user\n- ARTIFACTORY_PASSWORD - the password for the admin user\n- ARTIFACTORY_ENCRPT - the encrypted password for the admin user. This value is initially blank\nand must be updated after the value is generated in the UI\n- ARTIFACTORY_ADMIN_ACCESS_USER - the admin access user\n- ARTIFACTORY_ADMIN_ACCESS_PASSWORD - the admin access password\n\n### Jenkins config\n\n#### `jenkins-config` config map\n\n- JENKINS_HOST - the host name of the Jenkins ingress\n- JENKINS_URL - the url of the Jenkins ingress\n\n#### `jenkins-access` secret\n\n- api_token - the Jenkins api token\n- host - the host name of the Jenkins ingress\n- url - the url of the Jenkins ingress\n- username - the Jenkins user name\n- password - the Jenkins password\n\n### PactBroker config\n\n#### `pactbroker-config` config map\n\n- PACTBROKER_URL - the url of the Pact Broker ingress\n\n### SonarQube config\n\n#### `sonarqube-config` config map\n\n- SONARQUBE_URL - the url of the SonarQube ingress\n\n#### `sonarqube-access` secret\n\n- SONARQUBE_USER - the user name of the SonarQube user\n- SONARQUBE_PASSWORD - the password of the SonarQube user\n","type":"Mdx","contentDigest":"d0578ce1be960bc631836df38d8569cd","counter":918,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Cluster Configuration"},"exports":{},"rawBody":"---\ntitle: Cluster Configuration\n---\n\n<PageDescription>\n\nWithin the created Kubernetes or OpenShift cluster there are a number secrets\nand config maps that are either provided by the IBM Cloud public environment and\nutilized by the Terraform scripts or are created during the Terraform provisioning\nprocess.\n\n</PageDescription>\n\n\n## Namespaces\n\nThe Iteration Zero scripts create four namespaces that are used by the components deployed into the cluster: `tools`, \n`dev`, `test`, and `staging`. The actual names used for the namespaces are provided in Terraform variables with the\ndefaults being those listed. The variables are then passed into the namespaces module in `stage1-namespaces.tf`.\n\n## Provided resources\n\n### TLS secret\n\nWhen the cluster is created, a secret containing the TLS certs for the ingress subdomain is provided in the \n`default` namespace. The the name of the secret is based off of the cluster name with some rules applied to limit the\nlength and replace disallowed characters.\n\n**Note:** To avoid issues with the naming conventions for the secret, the Iteration Zero scripts look for the secret\nthat has a `tls.key` value: `kubectl get secrets -o jsonpath='{.items[?(@.data.tls\\.key != \"\")].metadata.name}'`.\nIdeally this would be identified using a label and a selector...\n\nDuring the Iteration Zero process, the TLS secret is copied into each of the four namespaces created and used by the \nIteration Zero processes.\n\n### Pull secrets\n\nPull secrets for the IBM Cloud Image Registry are generated in the cluster as part of the Iteration Zero process to \nprepare the namespaces. The secrets are initially created in the `default` namespace with the following names:\n- `default-icr-io` \n- `default-{region}-icr-io` \n\nDuring the namespace preparation process, the pull secrets are copied into the different namespaces with `default-`\nprefix dropped. E.g.\n- `icr-io`\n- `{region}-icr-io`\n\nThe pull secrets are also added to the `default` service account in each of the namespaces. As a result, it is not \nnecessary to directly reference the pull secret as long as the pod runs under the default service account.\n\n## Created resources\n\nThe following resources are all created during the Iteration Zero provisioning process. These resources\nare used generally to expose the config of the installed tools but specifically used by the CI pipeline ([Jenkins](/tools/continuous-integration), [Tekton](/tools/continuous-integration-tekton), etc.) to interact with the deployed tools. The resources are bound as optional environment variables\nin the containers used within the pipeline so if a particular tool has not been installed the\nassociated environment variables won't be set. For example:\n\n```yaml\n  envFrom:\n    - configMapRef:\n        name: pactbroker-config\n        optional: true\n    - configMapRef:\n        name: sonarqube-config\n        optional: true\n    - secretRef:\n        name: sonarqube-access\n        optional: true\n```\n\n### IBM Cloud config\n\nThe Iteration Zero script creates a config map and secret named `ibmcloud-config` and `ibmcloud-access`\nin the `default` namespace that contains the relevant configuration values for the cluster within the IBM \nCloud account. The config map and secret are copied into each of the Iteration Zero namespaces as the \nnamespaces are created.\n\n#### `ibmcloud-config` config map\n \nThe following values are collected:\n \n- CLUSTER_TYPE - the type of cluster (kubernetes or openshift)\n- APIURL - the api url used to connect to the IBM Cloud environment\n- SERVER_URL - the server url used to connect to the cluster, particularly for OpenShift\n- RESOURCE_GROUP - the IBM Cloud resource group where the cluster has been installed\n- REGISTRY_URL - the url to the image registry\n- REGISTRY_NAMESPACE - the namespace within the image registry where images will be stored\n- REGION - the IBM Cloud region where where the cluster has been installed\n- CLUSTER_NAME - the name of the cluster\n- INGRESS_SUBDOMAIN - the subdomain for the cluster to use in building ingress urls\n- TLS_SECRET_NAME - the name of the secret that contains the TLS certificate information\n\n#### `ibmcloud-access` secret\n\nThe following values are collected:\n\n- APIKEY - the IBM Cloud apikey used to access the environment\n\n### ArgoCD config\n\n#### `argocd-config` config map\n\n- ARGOCD_URL - the url of the ArgoCD ingress\n\n#### `argocd-access` secret\n\n- ARGOCD_PASSWORD - the password for the argocd user\n- ARGOCD_USER - the user id of the argocd user\n\n### Artifactory config\n\n#### `artifactory-config` config map\n\n- ARTIFACTORY_URL - the url for the Artifactory ingress\n\n#### `artifactory-access` config map\n\n- ARTIFACTORY_USER - the user name of the admin user\n- ARTIFACTORY_PASSWORD - the password for the admin user\n- ARTIFACTORY_ENCRPT - the encrypted password for the admin user. This value is initially blank\nand must be updated after the value is generated in the UI\n- ARTIFACTORY_ADMIN_ACCESS_USER - the admin access user\n- ARTIFACTORY_ADMIN_ACCESS_PASSWORD - the admin access password\n\n### Jenkins config\n\n#### `jenkins-config` config map\n\n- JENKINS_HOST - the host name of the Jenkins ingress\n- JENKINS_URL - the url of the Jenkins ingress\n\n#### `jenkins-access` secret\n\n- api_token - the Jenkins api token\n- host - the host name of the Jenkins ingress\n- url - the url of the Jenkins ingress\n- username - the Jenkins user name\n- password - the Jenkins password\n\n### PactBroker config\n\n#### `pactbroker-config` config map\n\n- PACTBROKER_URL - the url of the Pact Broker ingress\n\n### SonarQube config\n\n#### `sonarqube-config` config map\n\n- SONARQUBE_URL - the url of the SonarQube ingress\n\n#### `sonarqube-access` secret\n\n- SONARQUBE_USER - the user name of the SonarQube user\n- SONARQUBE_PASSWORD - the password of the SonarQube user\n","fileAbsolutePath":"/home/runner/work/ibm-garage-developer-guide/ibm-garage-developer-guide/src/pages/admin/cluster-configuration/index.mdx"}}},"staticQueryHashes":["1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","3273249464","63531786","63531786","768070550"]}